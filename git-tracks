#!/bin/bash
#
# Usage: git tracks [branch]
#
# Get the upstream branch of the given branch.  If no branch is given, get the
# upstream branch of the currrent branch.
#
# If -d/--default is passed, outputs origin/master if there's no upstream
# branch.
#
# To set <branch>'s upstream branch, run
#
#   $ git branch --set-upstream <branch> <upstream>
#
#
# Based on http://serverfault.com/a/352236/38694

if [[ "$1" == "-d" || "$1" == "--default" ]]; then
  branch=HEAD
else
  branch=$1
fi

branchref=$(git rev-parse --symbolic-full-name $branch) || exit $?
git for-each-ref --format='%(upstream:short)' $branchref
